---
title: "Group Lab 1"
output: html_document
author: Group 4

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1: Understanding Our Data
This dataset is derived from the [All China Data Center](https://chinadatacenter.net/Data/Services.aspx) which is formerly affiliated with the University of Michigan. The All China Data Center is run by the All China Marketing Research company, a private research firm. 

While it seems odd that cities like Shanghai and Beijing are included in statistics with provinces, they are special cases in that they are technically [municipalities](https://en.wikipedia.org/wiki/Direct-administered_municipalities_of_China). They have a higher political status than other types of cities, and are considered to be on the same level as provinces. Because they are under direct control of the central government, they are included in this dataset. Other major cities of Tianjin and Chongqing are also classified as municipalities.

Additionally, Hong Kong and [Macau](https://en.wikipedia.org/wiki/Macau) are not included in this dataset becuase although they are "special administrative regions" (SAR) of the PRC, SAR's are "highly autonomous and self-governing sub national subject of the People's Republic of China that is directly under the Central People's Government". In this way, Hong Kong and Macau control their own economies, are only really tied to China in terms of foreign policy and military/defense and therefore produce economic statistics through their own governments. To view Macau's economic data it can be accessed [here](https://www.gov.mo/en/about-macao-sar/statistics/). To view Hong Kong's economic data it can be accessed [here](https://www.hkeconomy.gov.hk/en/situation/index.htm). <!-- Should we include something about Taiwan in this section? -->


<!--Explain the time periods that might be the least reliable, and maybe summarize some of the suggested methods for “correcting” things like GDP data. *Need help with this section- I have not found what time periods are the least reliable nor have I found methods?? See the comments and if you have data, please add-->
Chinese statistics have been notoriously flawed for several reasons ranging from imprecise units of measurement to a lack of attention toward rural areas. In the late 1950s, statistics were seen as a way to show off accomplishment, rather than to communicate accurate and useful data. Throughout the 1950s there was a shortage of employees qualified to handle this data. As a consequence, workers were pressured to submit whatever report they had, regardless of accuracy. This led to a "virtual blackout" in the early 1960s. <!--This article also says that heavy industry statistics tend to be more accurate than those of light industry - wonder how this relates to the data?--> There is a very different cultural attitude toward statistical information than in the US. It is not only due to wanting to present itself well, but a common viewpoint in China is that "a slight discrepancy in figures does no harm".
Generally speaking, economic statistics produced by the central government are consistently inflated in comparison to those produced locally/regionally. The central government has long evaluated local government officials on the basis of The National Bureau of Statistics of China's GDP. Because of this motivation to inflate national statistics, the socialist period (1949-1980) will include <!-- probably inflated data? --> the "reform and opening period" beginning in 1982 will include <!-- more accurate data reflecting changes in the more-free market ? -->
In 2017 China established the Statistical Law Enforcement Supervision Bureau and the government issued “Regulations for Implementation of the Law on Statistics,” which were intended to enable punishment of statistics forgery. 
Statistics produced by private organizations tend to have more accurate data than those produced by the central government.
<!-- general source for this, Phil just said this in the lab 1 prompt -->

Sources: 

* [Economic History of China, 1949 to present](https://en.wikipedia.org/wiki/Economic_history_of_China_(1949%E2%80%93present))
* [How Trustworty are Chinese Statistics?, JapanForward](https://japan-forward.com/how-trustworthy-are-chinese-statistics-china-inflates-gdp-figures-by-478-billion-in-2017/)
* [Macau](https://en.wikipedia.org/wiki/Macau)
* [China Quietly Releases 2017 Provincial GDP Figures, Forbes](https://www.forbes.com/sites/salvatorebabones/2018/02/12/china-quietly-releases-2017-provincial-gdp-figures/#799c69ed20dc)
<!--Really interesting article from the CIA, goes into detail about Chinese history and statistics-->
* [The Problem of Chinese Statistics, CIA](https://www.cia.gov/library/center-for-the-study-of-intelligence/kent-csi/vol16no4/html/v17i1a07p_0001.htm)
<!--Here are a couple more articles on issues with Chinese statistics: https://www.economist.com/finance-and-economics/2018/07/07/chinas-statistics-are-bad-many-criticisms-of-them-are-worse and https://www.bloomberg.com/news/articles/2018-04-19/china-s-economic-stats-have-a-credibility-problem - I can send PDF copies if you run out of free articles to view on the sites-->

## Part 2: Exploring and Visualizing the Data

<!-- Explain interesting changes over time -->

<!-- 5 Visualizations + short explanations -->
```{r, include=FALSE}
library(plyr)
library(ggplot2)
library(tidyverse)
```
```{r, echo=FALSE}
object1 <- read.csv(file="China_EO_49to17.csv", fileEncoding = "latin1")
object2 <- as_tibble(object1)
object2$Year <- as.integer(object2$Year)
Year <- seq(from=1949,to=2017)
object2$Year <- Year
```
#write visualizations here
```{r, echo=FALSE}
municipalities <- select(object2, Year, Beijing_Enterprise, Tianjin_Enterprise, Shanghai_Enterprise, Chongqing_Enterprise)
MunicipalityComparison <- ggplot(data = municipalities, aes(x = Year)) # New ggplot
Colors <- c("Beijing" = "blueviolet", "Tianjin" = "red", "Shanghai" = "cyan3", "Chongqing" = "blue") # Colors and labels for legend
BJ <- geom_line(aes(y = Beijing_Enterprise, color = "Beijing"), size = 1.5)
TJ <- geom_line(aes(y = Tianjin_Enterprise, color = "Tianjin"), size = 1.5)
SH <- geom_line(aes(y = Shanghai_Enterprise, color = "Shanghai"), size = 1.5)
CQ <- geom_line(aes(y = Chongqing_Enterprise, color = "Chongqing"), size = 1.5)
MunicipalityComparison + BJ + TJ + SH + CQ + scale_color_manual(name="Municipality", values = Colors) + ggtitle("Change in Enterprise Counts in Chinese Municipalities") + theme_bw() + ylab("Enterprise Count")
```
<!--Gabby's visualization-->

China is essentially broken up into two main regions: the East and West regions, which are divided by the [15-inch Isohyet](https://www.forbes.com/sites/johnmauldin/2016/02/25/5-maps-that-explain-chinas-strategy/#3c257f4165b7). This line represents the divide based on annual rainfall needed for an agricultural economy. The Western provinces receive less than 15-inches of rainfall a year, resulting in smaller economic outputs. On the contrary, the Eastern provinces and municipalities get the majority of the yearly rainfall, which contribute to higher economic outputs and greater population density. Thus, this graph aims to show the significant total outputs each region has over the course of a 30-year period.

```{r, include=FALSE}
#Selecting 30-year period
filter(object2, Year == 1987 | Year == 1988 | Year == 1989 | Year == 1990 | Year == 1991 | Year == 1992 | Year == 1993 | Year == 1994 | Year == 1995 | Year == 1996 | Year == 1997 | Year == 1998 | Year == 1999 | Year == 2000 | Year == 2001 | Year == 2002 | Year == 2003 | Year == 2004 | Year == 2005 | Year == 2006 | Year == 2007 | Year == 2008 | Year == 2009 | Year == 2010 | Year == 2011 | Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016 | Year == 2017)

years30<- filter(object2, Year == 1987 | Year == 1988 | Year == 1989 | Year == 1990 | Year == 1991 | Year == 1992 | Year == 1993 | Year == 1994 | Year == 1995 | Year == 1996 | Year == 1997 | Year == 1998 | Year == 1999 | Year == 2000 | Year == 2001 | Year == 2002 | Year == 2003 | Year == 2004 | Year == 2005 | Year == 2006 | Year == 2007 | Year == 2008 | Year == 2009 | Year == 2010 | Year == 2011 | Year == 2012 | Year == 2013 | Year == 2014 | Year == 2015 | Year == 2016 | Year == 2017)
```

```{r, echo=TRUE, include=FALSE}
#All output values
select(years30,Year, Heilongjiang_Output, InnerMongolia_Output, Ningxia_Output, Gansu_Output, Qinghai_Output, Tibet_Output, Xinjiang_Output, Beijing_Output, Tianjin_Output, Hebei_Output, Shanxi_Output, Liaoning_Output, Jilin_Output, Shanghai_Output, Jiangsu_Output, Zhejiang_Output, Anhui_Output, Fujian_Output, Jiangxi_Output, Shandong_Output, Henan_Output, Hunan_Output, Hubei_Output, Guangdong_Output, Guangxi_Output, Hainan_Output, Chongqing_Output, Sichuan_Output, Guizhou_Output, Yunnan_Output, Shaanxi_Output)

all<- select(years30,Year, Heilongjiang_Output, InnerMongolia_Output, Ningxia_Output, Gansu_Output, Qinghai_Output, Tibet_Output, Xinjiang_Output, Beijing_Output, Tianjin_Output, Hebei_Output, Shanxi_Output, Liaoning_Output, Jilin_Output, Shanghai_Output, Jiangsu_Output, Zhejiang_Output, Anhui_Output, Fujian_Output, Jiangxi_Output, Shandong_Output, Henan_Output, Hunan_Output, Hubei_Output, Guangdong_Output, Guangxi_Output, Hainan_Output, Chongqing_Output, Sichuan_Output, Guizhou_Output, Yunnan_Output, Shaanxi_Output)
```

```{r, echo=TRUE, include=FALSE}
#Calculating Total Output for West Provinces
mutate(all,
       Total_Output_West = Heilongjiang_Output + InnerMongolia_Output + Ningxia_Output + Gansu_Output + Qinghai_Output + Tibet_Output + Xinjiang_Output)

all2<-mutate(all,
       Total_Output_West = Heilongjiang_Output + InnerMongolia_Output + Ningxia_Output + Gansu_Output + Qinghai_Output + Tibet_Output + Xinjiang_Output)
```

```{r, echo=TRUE, include=FALSE}
#Calculating Total Output for East Provinces
mutate(all2,
       Total_Output_East = Beijing_Output + Tianjin_Output + Hebei_Output + Shanxi_Output + Liaoning_Output + Jilin_Output + Shanghai_Output + Jiangsu_Output + Zhejiang_Output + Anhui_Output + Fujian_Output + Jiangxi_Output + Shandong_Output + Henan_Output + Hubei_Output + Hunan_Output + Guangdong_Output + Guangxi_Output + Hainan_Output + Chongqing_Output + Sichuan_Output + Guizhou_Output + Yunnan_Output + Shaanxi_Output)

final<- mutate(all2,
       Total_Output_East = Beijing_Output + Tianjin_Output + Hebei_Output + Shanxi_Output + Liaoning_Output + Jilin_Output + Shanghai_Output + Jiangsu_Output + Zhejiang_Output + Anhui_Output + Fujian_Output + Jiangxi_Output + Shandong_Output + Henan_Output + Hubei_Output + Hunan_Output + Guangdong_Output + Guangxi_Output + Hainan_Output + Chongqing_Output + Sichuan_Output + Guizhou_Output + Yunnan_Output + Shaanxi_Output)
```

```{r, echo=FALSE}
#Final Graph
#Plotting the 30-year span by the Total Output; distinguishing between East and West of the 15-inch Isohyet
gross_output<- ggplot(data=final, aes(x= Year))
NEW_colors<- c("West" = "coral1", "East" = "dodgerblue2")
WEST_new<- geom_line(aes(y= Total_Output_West, color="West"), size= 1.5, na.rm = TRUE)
EAST_new<- geom_line(aes(y= Total_Output_East, color="East"), size= 1.5, na.rm = TRUE)
gross_output + WEST_new + EAST_new + scale_color_manual(name= "Key", values = NEW_colors) +xlab("Year")+ylab("Total Output (100 million RMB)") + ggtitle("Total Gross Output of the East and West Provinces of China") +theme_gray() + theme(axis.text.x= element_text(size = 8)) + theme(axis.text.y= element_text(size = 8)) + theme(plot.title = element_text(hjust = 0.5)) + theme(axis.title.x = element_text(size= 11, face = "bold")) + theme(axis.title.y =element_text(size= 11, face = "bold")) + theme(plot.title = element_text(face = "bold", size = 14)) + scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) + scale_y_continuous(breaks = c(0, 100000, 200000, 300000, 400000, 500000, 600000, 700000)) 
```

## Part 3: Modifying the Data
<!--Function for output ratios, plot a few interesting comparisons-->

<!-- Plot and summarize relationship between output and number of enterprises for specific provinces -->
<!--Part 3 - 3rd step output/enterprise--> 
Tianjin is located on the Northeast coast of China, just to the southeast of Beijing. Over the past decade, this province has been one of China's [fastest growing economies](https://www.economist.com/china/2018/08/02/how-tianjin-once-chinas-fastest-growing-region-became-its-slowest). Recently, its economic output has begun to drastically decrease. Over the past few years, the province has been shifting away from their base of being one of China's hubs for both the mechanic and textile industry. This shift has caused Tianjin to increase its reliance on a [service based economy](http://china-trade-research.hktdc.com/business-news/article/Facts-and-Figures/Tianjin-Market-Profile/ff/en/1/1X000000/1X06BVTM.htm). In relation to gross output per enterprise, the province only began to pick up in the late-1990s and skyrocketed into the 2000s. Surprisingly, Tianjin has a quite high output per enterprise. This could be due to the increased reliance on the service economy. 

```{r, echo=FALSE, include=FALSE}
#Tianjin 
Tianjin<- select(object2, Year, Tianjin_Output, Tianjin_Enterprise)
mutate(Tianjin,
       Ratio = Tianjin_Output/Tianjin_Enterprise)
Tianjin_Ratio<- mutate(Tianjin,
       Ratio = Tianjin_Output/Tianjin_Enterprise)
```

```{r, echo=FALSE}
#Tianjin plot
TR<- ggplot(data = Tianjin_Ratio, aes(x = Year))
ratio<- geom_line(aes(y = Ratio), size = 1.2, na.rm = TRUE, color= "chartreuse3")
TR + ratio + xlab("Year") + ylab("Output/Enterprise") + ggtitle("Tianjin Province: Output per Enterprise per Year") + theme(axis.text.x= element_text(size = 8)) + theme(axis.text.y= element_text(size = 8)) + theme(plot.title = element_text(hjust = 0.5)) + theme(axis.title.y =element_text(size= 11, face = "bold")) + theme(axis.title.x =element_text(size= 11, face = "bold") )+ theme(plot.title = element_text(face = "bold", size = 14)) + scale_y_continuous(breaks = c(0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5))+ scale_x_continuous(breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2017))
```

Heilongjiang is China's northernmost province, sharing a border with Russia. Beginning in the late 1800s, Russia had strong influence over the region even though China continually tried to strengthen the province through agricultural production. By the Second World War, Russia and Japan had been fighting for control over the region, and after the Chinese Civil War it became the first province completely controlled by the [Communists](http://www.chinafolio.com/provinces/heilongjiang/). It wasn't until 2005 that Heilongjiang was governed under China officially. Its economy is largely based off of agriculture, timber, and [livestock](https://www.ipim.gov.mo/en/services/liaison-offices-in-mainland-china/liaison-office-of-shenyang/brief-introduction-of-economic-profile/brief-introduction-of-heilongjiang-province-economic-profile/). As you can see from the graph below, Heilongjiang has a low output per enterprise. From the data, it looks like the province has decreased the number of enterprised but has continued to strengthen their yearly outputs.

```{r, echo=FALSE, include=FALSE}
#Heilongjiang
Heilongjiang<- select(object2, Year, Heilongjiang_Output, Heilongjiang_Enterprise)
HR1<- mutate(Heilongjiang,
       Ratio = Heilongjiang_Output/Heilongjiang_Enterprise)
Heilongjiang_Ratio<- filter(HR1, Year != 2012)
```

```{r, echo=FALSE}
#Heilongjiang plot
HR<- ggplot(data = Heilongjiang_Ratio, aes(x = Year))
ratio_HR<- geom_line(aes(y = Ratio), size = 1.2, na.rm = TRUE, color= "chartreuse3")
HR + ratio_HR + xlab("Year") + ylab("Output/Enterprise") + ggtitle("Heilongjiang Province: Output per Enterprise per Year") + theme(axis.text.x= element_text(size = 8)) + theme(axis.text.y= element_text(size = 8)) + theme(plot.title = element_text(hjust = 0.5)) + theme(axis.title.y =element_text(size= 11, face = "bold")) + theme(axis.title.x =element_text(size= 11, face = "bold") )+ theme(plot.title = element_text(face = "bold", size = 14)) + scale_y_continuous(breaks = c(0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5))+ scale_x_continuous(breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2017))
```

As a major metropolitan municipality, Shanghai is home to just over [24 million people](http://worldpopulationreview.com/world-cities/shanghai-population/). Since the Opium War in the mid-1800s, it has been a key trading port and one of China's strongest economic centers. Due to its past successes as an industrial and commercial city, Shanghai's current diverse economy has contributed to its national and [international status](https://www.globalurban.org/GUD%20Shanghai%20MES%20Report.pdf). Out of the 166 different types of industry within China, 157 of them are within [Shanghai](http://www.china-window.com/china_economy/china_economy_guide/china-economy-shanghai.shtml). Shanghai's diverse economy supports large economic outputs each year, and builds upon this with a fairly steady number of enterprises within the municipality.         

```{r, echo=FALSE, include=FALSE}
#Shanghai
Shanghai<- select(object2, Year, Shanghai_Output, Shanghai_Enterprise)
mutate(Shanghai,
       Ratio = Shanghai_Output/Shanghai_Enterprise)
Shanghai_Ratio<- mutate(Shanghai,
       Ratio = Shanghai_Output/Shanghai_Enterprise)
```

```{r, echo=FALSE}
#Shanghai plot
SR<- ggplot(data = Shanghai_Ratio, aes(x = Year))
ratio_SR<- geom_line(aes(y = Ratio), size = 1.2, na.rm = TRUE, color= "chartreuse3")
SR + ratio_SR + xlab("Year") + ylab("Output/Enterprise") + ggtitle("Shanghai Municipality: Output per Enterprise per Year") + theme(axis.text.x= element_text(size = 8)) + theme(axis.text.y= element_text(size = 8)) + theme(plot.title = element_text(hjust = 0.5)) + theme(axis.title.y =element_text(size= 11, face = "bold")) + theme(axis.title.x =element_text(size= 11, face = "bold") )+ theme(plot.title = element_text(face = "bold", size = 14)) + scale_y_continuous(breaks = c(0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5))+ scale_x_continuous(breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2017))
```

Guizhou, located in the southwest, is one of China's least developed provinces. It's main sources of economy are agriculture, mining, and the production of [power, gas, and water](http://china-trade-research.hktdc.com/business-news/article/Facts-and-Figures/Guizhou-Market-Profile/ff/en/1/1X000000/1X06BUYK.htm). The graph clearly shows that this province has been struggling to gain a substantial amount of output, and the enterprises that reside there struggle to get much economic traction. Although, there might be some change on the horizon for Guizhou. In 2017 and 2018, the tech industry began staking land claims across the province. Companies like Apple, Qualcomm, and Alibaba aim to setup data centers alongside [cloud computing](http://www.xinhuanet.com/english/2018-05/29/c_137215216.htm). This could lead to big jumps in economic output for Guizhou in the near future. 

```{r, echo=FALSE, include=FALSE}
#Guizhou
Guizhou<- select(object2, Year, Guizhou_Output, Guizhou_Enterprise)
mutate(Guizhou,
       Ratio = Guizhou_Output/Guizhou_Enterprise)
Guizhou_Ratio<- mutate(Guizhou,
       Ratio = Guizhou_Output/Guizhou_Enterprise)
```

```{r, echo=FALSE}
#Guizhou plot
GR<- ggplot(data = Guizhou_Ratio, aes(x = Year))
ratio_GR<- geom_line(aes(y = Ratio), size = 1.2, na.rm = TRUE, color= "chartreuse3")
GR + ratio_GR + xlab("Year") + ylab("Output/Enterprise") + ggtitle("Guizhou Province: Output per Enterprise per Year") + theme(axis.text.x= element_text(size = 8)) + theme(axis.text.y= element_text(size = 8)) + theme(plot.title = element_text(hjust = 0.5)) + theme(axis.title.y =element_text(size= 11, face = "bold")) + theme(axis.title.x =element_text(size= 11, face = "bold") )+ theme(plot.title = element_text(face = "bold", size = 14)) + scale_y_continuous(breaks = c(0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5))+ scale_x_continuous(breaks = c(1950, 1960, 1970, 1980, 1990, 2000, 2010, 2017))
```
<!-- Find other data, visualize it, use it to modify existing data and visualize result -->
<!-- "Hidden" variables, visualize, maybe use statistical tests -->
<!-- Aggregate data by region -->
